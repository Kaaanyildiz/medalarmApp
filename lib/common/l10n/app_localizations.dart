import 'package:flutter/material.dart';

class AppLocalizations {
  final Locale locale;

  AppLocalizations(this.locale);

  // Helper method to keep the code in the widgets concise
  static AppLocalizations of(BuildContext context) {
    return Localizations.of<AppLocalizations>(context, AppLocalizations)!;
  }

  // Static member to have a simple access to the delegate from the MaterialApp
  static const LocalizationsDelegate<AppLocalizations> delegate =
      _AppLocalizationsDelegate();

  // Uygulamanın desteklediği diller
  static const List<Locale> supportedLocales = [
    Locale('tr', 'TR'),
    Locale('en', 'US'),
  ];

  // Mevcut cihazın yerel ayarlarına göre veya kullanıcı tercihine göre 
  // uygun dil belirleme
  static Locale? localeResolutionCallback(
      Locale? deviceLocale, Iterable<Locale> supportedLocales) {
    // Önce kullanıcının tercihine bakılır (shared preferences'dan okunur)
    
    // Kullanıcı tercihi yoksa cihaz diline bakılır
    for (var locale in supportedLocales) {
      if (deviceLocale != null &&
          deviceLocale.languageCode == locale.languageCode) {
        return locale;
      }
    }
    
    // Eşleşme yoksa varsayılan olarak Türkçe
    return const Locale('tr', 'TR');
  }

  // Metinlerin çevirileri
  late Map<String, String> _localizedStrings;

  // Gelecekte bu metotlar bir JSON dosyasından yükleme yapacak şekilde değiştirilebilir
  Future<bool> load() async {
    // Şimdilik hard-coded çeviriler
    _localizedStrings = _getTranslations();
    return true;
  }

  String translate(String key) {
    return _localizedStrings[key] ?? key;
  }
  Map<String, String> _getTranslations() {
    if (locale.languageCode == 'tr') {      return {
        'app_name': 'MedAlarm',
        'save': 'Kaydet',
        'cancel': 'İptal',
        'delete': 'Sil',
        'edit': 'Düzenle',
        'yes': 'Evet',
        'no': 'Hayır',
        'ok': 'Tamam',
        'error': 'Hata',
        'success': 'Başarılı',
        'warning': 'Uyarı',
        'information': 'Bilgi',
        'loading': 'Yükleniyor',
        'medications': 'İlaçlarım',
        'calendar': 'Takvim',
        'reports': 'Raporlar',
        'profile': 'Profil',
        'inventory': 'Envanter',
        'add_medication': 'İlaç Ekle',
        'medication_name': 'İlaç Adı',
        'dosage': 'Doz',
        'frequency': 'Sıklık',
        'daily': 'Günlük',
        'weekly': 'Haftalık',
        'monthly': 'Aylık',
        'start_date': 'Başlangıç Tarihi',
        'end_date': 'Bitiş Tarihi',
        'reminder_time': 'Hatırlatma Zamanı',
        'notes': 'Notlar',
        'dark_mode': 'Karanlık Mod',
        'language': 'Dil',
        'select_language': 'Dil Seçimi',
        'language_info_note': 'Uygulama dilini değiştirdiğinizde bazı ekranlar yeniden başlatılabilir.',
        'turkish': 'Türkçe',
        'english': 'İngilizce',
        'notification_settings': 'Bildirim Ayarları',
        'sound': 'Ses',
        'vibration': 'Titreşim',
        'help': 'Yardım',
        'about': 'Hakkında',
        'logout': 'Çıkış Yap',
        'login': 'Giriş Yap',
        'register': 'Kayıt Ol',
        'username': 'Kullanıcı Adı',
        'password': 'Şifre',
        'active': 'Aktif',
        'inactive': 'Pasif',
        'adherence': 'Uyum',
        'missed_doses': 'doz alınmadı',
        'forgot_password': 'Şifremi Unuttum',
        'email': 'E-posta',
        'phone': 'Telefon',
        'address': 'Adres',
        'birth_date': 'Doğum Tarihi',
        'gender': 'Cinsiyet',
        'male': 'Erkek',
        'female': 'Kadın',
        'other': 'Diğer',
        'save_changes': 'Değişiklikleri Kaydet',
        'discard_changes': 'Değişiklikleri İptal Et',
        'medication_added': 'İlaç eklendi',
        'medication_updated': 'İlaç güncellendi',
        'medication_deleted': 'İlaç silindi',
        'confirm_delete': 'Silmek istediğinize emin misiniz?',
        'no_medications': 'Henüz ilaç eklenmemiş',
        'no_reminders': 'Henüz hatırlatma yok',
        'today': 'Bugün',
        'tomorrow': 'Yarın',
        'yesterday': 'Dün',
        'upcoming': 'Yaklaşan',
        'past': 'Geçmiş',
        'morning': 'Sabah',
        'afternoon': 'Öğle',
        'evening': 'Akşam',
        'night': 'Gece',
        'before_meal': 'Yemekten Önce',
        'after_meal': 'Yemekten Sonra',
        'with_meal': 'Yemekle Birlikte',
        'on_empty_stomach': 'Aç Karnına',
        'remaining': 'Kalan',
        'taken': 'Alındı',
        'missed': 'Kaçırıldı',
        'skip': 'Atla',
        'next': 'İleri',
        'back': 'Geri',
        'done': 'Tamamlandı',
        'settings': 'Ayarlar',
        'general_settings': 'Genel Ayarlar',
        'account_settings': 'Hesap Ayarları',
        'privacy_settings': 'Gizlilik Ayarları',
        'terms_conditions': 'Kullanım Koşulları',
        'privacy_policy': 'Gizlilik Politikası',
        'contact_us': 'Bize Ulaşın',
        'send_feedback': 'Geribildirim Gönder',
        'rate_app': 'Uygulamayı Değerlendir',
        'share_app': 'Uygulamayı Paylaş',
        'version': 'Versiyon',
        'welcome': 'Hoş Geldiniz',
        'welcome_back': 'Tekrar Hoş Geldiniz',
        'continue_with': 'ile Devam Et',
        'or': 'veya',
        'by_continuing': 'Devam ederek',
        'agree_to': 'kabul etmiş olursunuz',
        'and': 've',
        'forgot': 'Unuttum',
        'remember_me': 'Beni Hatırla',
        'sign_in': 'Giriş Yap',
        'sign_up': 'Kayıt Ol',
        'already_have_account': 'Zaten hesabınız var mı?',
        'dont_have_account': 'Hesabınız yok mu?',
        'create_account': 'Hesap Oluştur',
        'your_name': 'Adınız',
        'confirm_password': 'Şifreyi Onayla',        'emergency_contact': 'Acil Durum Kişisi',
        'add_emergency_contact': 'Acil Durum Kişisi Ekle',
        'refresh_data': 'Verileri Yenile',
        'medications_refreshed': 'İlaç verileri yenilendi',
        
        // Rapor ekranı için çeviriler
        'overview_tab': 'Genel Bakış',
        'adherence_reports_tab': 'Uyum Raporları',
        'medication_details_tab': 'İlaç Detayları',
        'health_metrics_tab': 'Sağlık Metrikleri',
        'select_report_period': 'Rapor dönemini seç',
        'last_7_days': 'Son 7 Gün',
        'last_30_days': 'Son 30 Gün',
        'last_365_days': 'Son 365 Gün',
        'no_medication_data': 'Henüz ilaç kullanım verisi bulunmuyor',
        'good': 'İyi',
        'medium': 'Orta',
        'low': 'Düşük',
        'medications_to_watch': 'Dikkat Edilmesi Gereken İlaçlar',
        'overall_adherence_rate': 'Genel İlaç Uyum Oranı',
        'total_doses_format': 'Toplam {taken} / {planned} doz alındı',
        'medication_singular': 'İlaç',
        'adherence_percent': 'Uyum',
        'taken_doses': 'Alınan',
        'skipped_doses': 'Atlanmış',
        'delayed_doses': 'Gecikmiş',
        'total_doses': 'Toplam',
        'daily_medication_adherence': 'Günlük İlaç Uyum Grafiği',
        'select_medication': 'İlaç Seçin',
        'no_records_for_medication': 'Bu ilaç için kayıt bulunamadı',
        'body_measurements': 'Vücut Ölçümleri',
        'health_advice': 'Sağlık Tavsiyeleri',        'bmi_thin': 'Zayıf',
        'bmi_normal': 'Normal',
        'bmi_overweight': 'Fazla Kilolu',
        'bmi_obese_value': 'Obez',
        'health_metrics_not_available': 'Sağlık metrikleriniz görüntülenemedi','add_height_weight_prompt': 'Boy ve kilo bilgilerinizi profilinizden ekleyerek sağlık metriklerinizi görüntüleyebilirsiniz',
        'edit_profile_info': 'Profil Bilgilerimi Düzenle',
        'report_refresh_data': 'Verileri Yenile',
        'report_medications_refreshed': 'İlaç verileri yenilendi',
        
        // Inventory screen translations
        'medication_inventory': 'İlaç Stok Takibi',
        'refresh': 'Yenile',
        'all_medications': 'Tüm İlaçlar',
        'low_stock': 'Az Kalan',
        'out_of_stock': 'Biten',
        'medications_count': 'İlaçlar ({count})',
        'update_stock': 'Stok Güncelle',
        'no_medications_added': 'Henüz İlaç Eklenmemiş',
        'add_medications_prompt': 'Stok takibi için ilaçlarınızı ekleyin.',
        'stock_status_good': 'Stok Durumu İyi',
        'no_low_stock': 'Şu anda stok seviyesi düşük olan ilaç bulunmuyor.',
        'stock_complete': 'Stok Tamam',
        'no_out_of_stock': 'Şu anda stoku biten ilaç bulunmuyor.',
        'current_stock': 'Mevcut Stok',
        'stock_threshold': 'Stok Eşiği',        'stock_unit': 'Birim',
        'sort_by': 'Sırala',
        'name': 'İsim',        'stock_level': 'Stok Seviyesi',        'stock': 'Stok',
        'no_stock_info': 'Stok bilgisi yok',
        'stock_depleted': 'Stok tükendi!',
        'inventory_units_count': 'adet',
        'remaining': 'kaldı',
        'approx': 'yaklaşık',
        'days': 'gün',
        'no_last_refill': 'Son stok girişi yok',
        'last_refill': 'Son stok',
        'times_per_day_format': 'Günde {times} kez, her seferde {doses} doz',
        'medication': 'İlaç',
        'medication_details': 'İlaç Detayları',
        
        // Gün isimleri
        'monday': 'Pazartesi',
        'tuesday': 'Salı',
        'wednesday': 'Çarşamba',
        'thursday': 'Perşembe',
        'friday': 'Cuma',
        'saturday': 'Cumartesi',
        'sunday': 'Pazar',
        
        // Bildirim kanalı
        'notification_channel_name': 'İlaç Hatırlatmaları',
        'notification_channel_description': 'İlaç hatırlatmaları için bildirim kanalı',
      };
    } else {
      // İngilizce çeviriler
      return {
        'app_name': 'MedAlarm',
        'save': 'Save',
        'cancel': 'Cancel',
        'delete': 'Delete',
        'edit': 'Edit',
        'yes': 'Yes',
        'no': 'No',
        'ok': 'OK',
        'error': 'Error',
        'success': 'Success',
        'warning': 'Warning',
        'information': 'Information',
        'loading': 'Loading',
        'medications': 'My Medications',
        'calendar': 'Calendar',
        'reports': 'Reports',
        'profile': 'Profile',
        'inventory': 'Inventory',
        'add_medication': 'Add Medication',
        'medication_name': 'Medication Name',
        'dosage': 'Dosage',
        'frequency': 'Frequency',
        'daily': 'Daily',
        'weekly': 'Weekly',
        'monthly': 'Monthly',
        'start_date': 'Start Date',
        'end_date': 'End Date',
        'reminder_time': 'Reminder Time',
        'notes': 'Notes',
        'dark_mode': 'Dark Mode',
        'language': 'Language',
        'select_language': 'Select Language',
        'language_info_note': 'Some screens may need to restart after changing the application language.',
        'turkish': 'Turkish',
        'english': 'English',
        'notification_settings': 'Notification Settings',
        'sound': 'Sound',
        'vibration': 'Vibration',
        'help': 'Help',
        'about': 'About',
        'logout': 'Logout',
        'login': 'Login',
        'register': 'Register',
        'username': 'Username',
        'password': 'Password',
        'active': 'Active',
        'inactive': 'Inactive',
        'adherence': 'Adherence',
        'missed_doses': 'missed doses',
        'forgot_password': 'Forgot Password',
        'email': 'Email',
        'phone': 'Phone',
        'address': 'Address',
        'birth_date': 'Birth Date',
        'gender': 'Gender',
        'male': 'Male',
        'female': 'Female',
        'other': 'Other',
        'save_changes': 'Save Changes',
        'discard_changes': 'Discard Changes',
        'medication_added': 'Medication added',
        'medication_updated': 'Medication updated',
        'medication_deleted': 'Medication deleted',
        'confirm_delete': 'Are you sure you want to delete?',
        'no_medications': 'No medications added yet',
        'no_reminders': 'No reminders yet',
        'today': 'Today',
        'tomorrow': 'Tomorrow',
        'yesterday': 'Yesterday',
        'upcoming': 'Upcoming',
        'past': 'Past',
        'morning': 'Morning',
        'afternoon': 'Afternoon',
        'evening': 'Evening',
        'night': 'Night',
        'before_meal': 'Before Meal',
        'after_meal': 'After Meal',
        'with_meal': 'With Meal',
        'on_empty_stomach': 'On Empty Stomach',
        'remaining': 'Remaining',
        'taken': 'Taken',
        'missed': 'Missed',
        'skip': 'Skip',
        'next': 'Next',
        'back': 'Back',
        'done': 'Done',
        'settings': 'Settings',
        'general_settings': 'General Settings',
        'account_settings': 'Account Settings',
        'privacy_settings': 'Privacy Settings',
        'terms_conditions': 'Terms & Conditions',
        'privacy_policy': 'Privacy Policy',
        'contact_us': 'Contact Us',
        'send_feedback': 'Send Feedback',
        'rate_app': 'Rate App',
        'share_app': 'Share App',
        'version': 'Version',
        'welcome': 'Welcome',
        'welcome_back': 'Welcome Back',
        'continue_with': 'Continue with',
        'or': 'or',
        'by_continuing': 'By continuing, you',
        'agree_to': 'agree to',
        'and': 'and',
        'forgot': 'Forgot',
        'remember_me': 'Remember Me',
        'sign_in': 'Sign In',
        'sign_up': 'Sign Up',
        'already_have_account': 'Already have an account?',
        'dont_have_account': 'Don\'t have an account?',
        'create_account': 'Create Account',
        'your_name': 'Your Name',
        'confirm_password': 'Confirm Password',        
        'emergency_contact': 'Emergency Contact',
        'add_emergency_contact': 'Add Emergency Contact',
        'health_summary': 'Health Summary',
        'personal_info': 'Personal Information',
        'name_not_entered': 'Name Not Entered',
        'age_years': '{age} years old',
        'health_condition': 'Health Condition',
        'bmi': 'BMI',
        'height': 'Height',
        'weight': 'Weight',
        'add_height_weight': 'Add Height/Weight',
        'update': 'Update',
        'add_height_weight_prompt': 'Add your height and weight information',
        'bmi_calculation_note': 'For BMI calculation and more personalized recommendations, enter your height and weight.',
        'medication_statistics': 'Medication Statistics',
        'active_medications': 'Active Medications',
        'adherence_rate': 'Adherence Rate',
        'todays_doses': 'Today\'s Doses',
        'weekly_adherence': 'Weekly Medication Adherence',
        'medication_timing': 'Medication Timing',
        'on_time': 'On Time',
        'delayed': 'Delayed',
        'skipped': 'Skipped',
        'adherence_low': 'Your medication adherence is low. Consider enabling reminders to take your medications regularly.',
        'adherence_medium': 'Your medication adherence is moderate. Try to take your medications more regularly for better results.',
        'adherence_high': 'Your medication adherence is high. Keep up the good work!',
        'emergency_contacts': 'Emergency Contacts',
        'no_emergency_contacts': 'No emergency contacts added yet',
        'edit_profile': 'Edit Profile',
        'notification_and_alarm_settings': 'Notification and Alarm Settings',
        'notifications': 'Notifications',
        'alarms': 'Alarms',
        'alarm_type': 'Alarm Type',
        'vibrate': 'Vibrate',
        'reminder_interval': 'Reminder Interval',
        'edit_notification_settings': 'Edit Notification Settings',
        'medication_reminders': 'Medication Reminders',
        'sound_alarms': 'Sound Alarms',
        'play_alarm_when_medication_due': 'Play alarm when medication is due',
        'medication_reminder': 'Medication Reminder',
        'standard_reminder_sound': 'Standard reminder sound',
        'emergency_alarm': 'Emergency Alarm',
        'louder_alarm': 'Louder alarm',
        'gentle_alarm': 'Gentle Alarm',
        'softer_alarm': 'Softer alarm sound',
        'custom_alarm': 'Custom Alarm',
        'use_different_notification_sound': 'Use different notification sound',
        'alarm_duration': 'Alarm Duration',
        'seconds': 'seconds',        
        'notification_with_vibration': 'Notification with vibration',
        'reminder_repeat_interval': 'Reminder Repeat Interval',
        'reminder_repeat_description': 'Time to repeat reminder if medication is not taken',
        'minutes': 'minutes',        
        'notify_on_missed_doses': 'Notify on missed doses',
        'optional': 'Optional',
        'edit_emergency_contact': 'Edit Emergency Contact',
        'delete_emergency_contact_btn': 'Delete Emergency Contact',
        'confirm_delete': 'Are you sure you want to delete this contact?','call': 'Call',
        'message': 'Message',
        'send_email': 'Send Email',
        'fill_required_fields': 'Please fill in all required fields',
        'full_name': 'Full Name',
        'emergency_relationship': 'Relationship',
        'emergency_phone': 'Phone',
        'email_optional': 'Email (Optional)',
        'add': 'Add',
        'update_contact': 'Update',
        'alarm_settings': 'Alarm Settings',
        'notification_description': 'Notifications for medication reminders',
        'sound_alarms_description': 'Play sound when medication is due',
        'alarm_type_setting': 'Alarm Type',
        'medication_reminder_alarm': 'Medication Reminder',
        'emergency_alarm_type': 'Emergency Alarm',
        'gentle_alarm_type': 'Gentle Alarm',        'custom_alarm_type': 'Custom Alarm',
        'standard_sound': 'Standard reminder sound',
        'louder_alarm_description': 'Louder alarm sound',
        'softer_alarm_description': 'Softer alarm sound',
        'custom_sound_description': 'Use different notification sound',
        'vibration_setting': 'Vibration',
        'vibration_description': 'Vibration with notification',
        'reminder_repeat_time': 'Reminder Repeat Time',
        'reminder_not_taken_description': 'Time to repeat reminder if medication is not taken',
        'edit_notification_settings_button': 'Edit Notification Settings',
        'notification_settings_updated': 'Notification settings updated',
        'on': 'On',
        'off': 'Off',
        'call_failed': 'Phone call failed',
        'sms_failed': 'SMS failed to send',
        'email_failed': 'Email failed to send',
        'please_enter_age': 'Please enter your age',
        'enter_valid_age': 'Please enter a valid age (1-120)',        'enter_valid_weight': 'Please enter a valid weight (1-500 kg)',
        
        // Report screen translations
        'overview_tab': 'Overview',
        'adherence_reports_tab': 'Adherence Reports',
        'medication_details_tab': 'Medication Details',
        'health_metrics_tab': 'Health Metrics',
        'select_report_period': 'Select report period',
        'last_7_days': 'Last 7 Days',
        'last_30_days': 'Last 30 Days',
        'last_365_days': 'Last 365 Days',
        'no_medication_data': 'No medication usage data available yet',
        'good': 'Good',
        'medium': 'Medium',
        'low': 'Low',
        'medications_to_watch': 'Medications to Watch',
        'overall_adherence_rate': 'Overall Medication Adherence Rate',
        'total_doses_format': 'Total {taken} / {planned} doses taken',
        'medication_singular': 'Medication',
        'adherence_percent': 'Adherence',
        'taken_doses': 'Taken',
        'skipped_doses': 'Skipped',
        'delayed_doses': 'Delayed',
        'total_doses': 'Total',
        'daily_medication_adherence': 'Daily Medication Adherence Chart',
        'select_medication': 'Select Medication',
        'no_records_for_medication': 'No records found for this medication',
        'body_measurements': 'Body Measurements',
        'health_advice': 'Health Advice',        'bmi_thin': 'Underweight',
        'bmi_normal': 'Normal Weight',
        'bmi_overweight': 'Overweight',
        'bmi_obese_value': 'Obese',
        'health_metrics_not_available': 'Health metrics not available','add_height_weight_prompt': 'Add your height and weight in your profile to view your health metrics',
        'edit_profile_info': 'Edit Profile Information',
        'report_refresh_data': 'Refresh Data',
        'report_medications_refreshed': 'Medication data refreshed',
        
        // Inventory screen translations
        'medication_inventory': 'Medication Inventory',
        'refresh': 'Refresh',
        'all_medications': 'All Medications',
        'low_stock': 'Low Stock',
        'out_of_stock': 'Out of Stock',
        'medications_count': 'Medications ({count})',
        'update_stock': 'Update Stock',
        'no_medications_added': 'No Medications Added Yet',
        'add_medications_prompt': 'Add your medications for inventory tracking.',
        'stock_status_good': 'Stock Status Good',
        'no_low_stock': 'No medications with low stock level at the moment.',
        'stock_complete': 'Stock Complete',
        'no_out_of_stock': 'No medications out of stock at the moment.',
        'current_stock': 'Current Stock',
        'stock': 'Stock',
        'stock_threshold': 'Stock Threshold',
        'stock_unit': 'Unit',
        'sort_by': 'Sort By',        'name': 'Name',
        'stock_level': 'Stock Level',
        'no_stock_info': 'No stock information',
        'stock_depleted': 'Stock depleted!',
        'inventory_units_count': 'units',
        'remaining': 'remaining',
        'approx': 'approximately',        'days': 'days',
        'no_last_refill': 'No last refill date',
        'last_refill': 'Last refill',
        'times_per_day_format': '{times} times per day, {doses} dose(s) each time',
        'medication': 'Medication',
        'medication_details': 'Medication Details',
        
        // Day names
        'monday': 'Monday',
        'tuesday': 'Tuesday',
        'wednesday': 'Wednesday',
        'thursday': 'Thursday',
        'friday': 'Friday',
        'saturday': 'Saturday',
        'sunday': 'Sunday',
        
        // Notification channel
        'notification_channel_name': 'Medication Reminders',
        'notification_channel_description': 'Notification channel for medication reminders',
      };
    }
  }
}

class _AppLocalizationsDelegate extends LocalizationsDelegate<AppLocalizations> {
  const _AppLocalizationsDelegate();
  @override
  bool isSupported(Locale locale) {
    return AppLocalizations.supportedLocales
        .map((e) => e.languageCode)
        .contains(locale.languageCode);
  }

  @override
  Future<AppLocalizations> load(Locale locale) async {
    AppLocalizations localizations = AppLocalizations(locale);
    await localizations.load();
    return localizations;
  }

  @override
  bool shouldReload(_AppLocalizationsDelegate old) => false;
}
